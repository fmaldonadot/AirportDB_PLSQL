REM Final Project Advanced Data Base
REM Name: Francisco Maldonado
REM 
REM $Header: DB.sql 29/06/2017
REM
REM   NAME
REM     DB.sql - Build Oracle Data Browser Tables
REM   DESCRIPTION
REM     This SQL script builds the Oracle Data Browser  for a Airport Data.
REM   NOTES
REM     
REM     
REM   MODIFIED   (MM/DD/YY)
REM    

--Drop old datasources

CONNECT / AS SYSDBA
CREATE USER project IDENTIFIED BY project
DEFAULT TABLESPACE USERS;
GRANT CONNECT,RESOURCE TO project;

CONNECT project/project

DROP TABLE FLIGHT CASCADE CONSTRAINTS PURGE;
DROP TABLE PLANE CASCADE CONSTRAINTS PURGE;
DROP TABLE PILOT CASCADE CONSTRAINTS PURGE;
DROP TABLE CITY CASCADE CONSTRAINTS PURGE;

--Create new datasources

--Table CITY
CREATE TABLE CITY(
CITY_ID NUMBER(3) CONSTRAINT PK_CITY_ID PRIMARY KEY,
CITY_NAME VARCHAR2(20) NOT NULL);

--Table PILOT
CREATE TABLE PILOT(
PILOT_ID NUMBER(3),
LAST_NAME VARCHAR2(20) NOT NULL,
FIRST_NAME VARCHAR2(20),
CITY_ID NUMBER(3),
SALARY NUMBER(7,2),
CONSTRAINT PK_PILOT_ID PRIMARY KEY(PILOT_ID),
CONSTRAINT FK_PILOT_CITY_ID FOREIGN KEY(CITY_ID)
REFERENCES CITY(CITY_ID),
CONSTRAINT CK_PILOT_SALARY CHECK(SALARY>=5000 AND SALARY<=7500));

--Table PLANE
CREATE TABLE PLANE(
PLA_ID NUMBER(2),
PLA_DESC VARCHAR2(20),
MAX_PASSENGER NUMBER(3),
CITY_ID NUMBER(3),
CONSTRAINT PK_PLA_ID PRIMARY KEY(PLA_ID),
CONSTRAINT FK_PLANE_CITY_ID FOREIGN KEY(CITY_ID)
REFERENCES CITY(CITY_ID),
CONSTRAINT CK_PLANE_MAX_PASSENGER
CHECK(MAX_PASSENGER<=500));

--Table FLIGHT
CREATE TABLE FLIGHT(
FLIGHT_ID NUMBER(3),
PILOT_ID NUMBER(3),
PLA_ID NUMBER(2),
CITY_DEP NUMBER(3),
CITY_ARR NUMBER(3),
DEP_TIME NUMBER(4),
ARR_TIME NUMBER(4),
CONSTRAINT PK_FLIGHT_ID PRIMARY KEY(FLIGHT_ID),
CONSTRAINT FK_FLIGHT_PILOT_ID FOREIGN KEY(PILOT_ID) REFERENCES PILOT(PILOT_ID),
CONSTRAINT FK_FLIGHT_PLA_ID FOREIGN KEY(PLA_ID)
REFERENCES PLANE(PLA_ID),
CONSTRAINT FK_FLIGHT_CITY_DEP FOREIGN KEY(CITY_DEP) REFERENCES CITY(CITY_ID),
CONSTRAINT FK_FLIGHT_CITY_ARR FOREIGN KEY(CITY_ARR) REFERENCES CITY(CITY_ID),
CONSTRAINT CK_FLIGHT_DEP_TIME CHECK(DEP_TIME<ARR_TIME));

--Insert data into the database objects (Strings must be entered in uppercase).
--Insert data into the table CITY.

INSERT INTO CITY VALUES (100,'OTTAWA');
INSERT INTO CITY VALUES (101,'QUEBEC');
INSERT INTO CITY VALUES (102,'MONTREAL');
INSERT INTO CITY VALUES (103,'TORONTO');
INSERT INTO CITY VALUES (104,'VICTORIA');
INSERT INTO CITY VALUES (105,'EDMONTON');
COMMIT;

--Insert data into the table PILOT.

INSERT INTO PILOT VALUES (1,'FANTASSO','ALBERT',100,7000);
INSERT INTO PILOT VALUES (2,'PETERS','FRANK',101,7000);
INSERT INTO PILOT VALUES (3,'ROSS','PAUL',102,6000);
INSERT INTO PILOT VALUES (4,'MIRANDA','SERGE',100,5800);
INSERT INTO PILOT VALUES (5,'TALADOIRE','GILLES',101,6200);
INSERT INTO PILOT VALUES (6,'BONFILS','GERARD',101,6000);
INSERT INTO PILOT VALUES (7,'LAHRIRE','PHILLIPE',103,5200);
INSERT INTO PILOT VALUES (8,'MARCENAC','PIERRE',102,5800);
INSERT INTO PILOT VALUES (9,'CAVARERO','ERIC',102,6000);
INSERT INTO PILOT VALUES (10,'TAYLOR','ROBERT',100,6800);
COMMIT;

--Insert data into the table PLANE.

INSERT INTO PLANE VALUES (1,'A300',300,102);
INSERT INTO PLANE VALUES (2,'A310',300,102);
INSERT INTO PLANE VALUES (3,'B727',250,100);
INSERT INTO PLANE VALUES (4,'A300',280,103);
INSERT INTO PLANE VALUES (5,'CONCORDE',160,102);
INSERT INTO PLANE VALUES (6,'B747',460,100);
INSERT INTO PLANE VALUES (7,'B727',250,100);
INSERT INTO PLANE VALUES (8,'A310',300,101);
INSERT INTO PLANE VALUES (9,'B737',350,103);
INSERT INTO PLANE VALUES (10,'CONCORDE',160,100);
COMMIT;

--Insert data into the table FLIGHT.

INSERT INTO FLIGHT VALUES (100,1,1,102,103,1100,1430);
INSERT INTO FLIGHT VALUES (101,1,8,100,103,1700,2000);
INSERT INTO FLIGHT VALUES (102,2,1,101,103,1400,1600);
INSERT INTO FLIGHT VALUES (103,5,3,101,103,1800,2000);
INSERT INTO FLIGHT VALUES (104,9,1,100,102,0645,0730);
INSERT INTO FLIGHT VALUES (105,10,2,103,102,1100,1400);
INSERT INTO FLIGHT VALUES (106,1,4,102,103,0800,1100);
INSERT INTO FLIGHT VALUES (107,8,4,102,100,0715,0800);
INSERT INTO FLIGHT VALUES (108,1,8,104,103,0900,1300);
INSERT INTO FLIGHT VALUES (109,9,2,102,100,1215,1300);
INSERT INTO FLIGHT VALUES (110,4,5,100,103,1500,1800);
INSERT INTO FLIGHT VALUES (111,1,2,103,104,1630,2030);
INSERT INTO FLIGHT VALUES (112,4,5,102,105,1100,1420);
INSERT INTO FLIGHT VALUES (113,3,5,105,100,1500,1800);
INSERT INTO FLIGHT VALUES (114,8,9,100,101,1700,1830);
INSERT INTO FLIGHT VALUES (115,7,5,100,101,1800,1930);
COMMIT;